# Package managers

snapd:
  - apt
  - type: dnf
    post_install: |
      sudo ln -s /var/lib/snapd/snap /snap

pip:
  - type: dnf
    packages: [python3-pip]
  - type: apt
    packages: [python3-pip]

apt-transport-https: [apt]

dnf-automatic:
  - type: dnf
    post_install:
      # Se traduce en: printf "%s\n" "[commands]" "apply_updates=True" | sudo tee /etc/dnf/automatic.conf
      - type: tee
        destination: /etc/dnf/automatic.conf
        sudo: true
        content: |
          [commands]
          apply_updates=True

# Libraries

build-essential:
  - type: dnf
    packages: [make, cmake, gcc, gcc-c++]
  - type: apt
    packages: [build-essential]

gdb: [dnf, apt]

entr: [dnf, apt]

clang-tidy: [dnf, apt]

clang-format: [dnf, apt]

# CLI Tools

htop: [dnf, apt]

jq: [dnf, apt]

7z:
  - type: dnf
    packages: [p7zip]
  - type: apt
    packages: [p7zip-full]

stow: [dnf]

tree: [dnf, apt]

xxd: [dnf, apt]

git:
  - type: dnf
    post_install: |
      git config --global init.defaultBranch main
      git config --global user.email "aguseranieri@gmail.com"
      git config --global user.name "Agustin Ranieri"
      git config --global credential.username "RaniAgus"
      git config --global gpg.format ssh

# Desktop Applications

# dnf type translates into:
# sudo dnf install -y {{...packages}}

# deb type translates into this for ubuntu:
# @for (package of packages) {
#   TEMP_FILE=$(mktemp)
#   curl -o "$TEMP_FILE" {{package}}
#   sudo apt install "$TEMP_FILE"
#   rm "$TEMP_FILE"
# }

solaar: [dnf]

chrome:
  - type: dnf
    packages: [https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm]
  - type: deb
    packages: [https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb]

1password:
  - type: dnf
    packages: [https://downloads.1password.com/linux/rpm/stable/x86_64/1password-latest.rpm]
    post_install:
      - type: tee
        destination: ~/.config/autostart/1password.desktop
        content: |
          [Desktop Entry]
          Name=1Password
          Exec=1password --silent %U
          Terminal=false
          Type=Application
          Icon=1password
          StartupWMClass=1Password
          Comment=Password manager and secure wallet
          MimeType=x-scheme-handler/onepassword;
          Categories=Office;

1password-cli:
  - type: dnf
    depends_on:
      - 1password

zoom:
  - type: dnf
    packages: [https://zoom.us/client/latest/zoom_x86_64.rpm]
  - type: deb
    packages: [https://zoom.us/client/latest/zoom_amd64.deb]

gh:
  - type: dnf
    flags:
      - "--repo gh-cli"
    depends_on:
      - type: dnf
        packages: [dnf5-plugins]
    pre_install: |
      sudo dnf config-manager addrepo --from-repofile=https://cli.github.com/packages/rpm/gh-cli.repo

docker:
  - type: dnf
    packages:
      - docker
      - docker-ce
      - docker-ce-cli
      - containerd.io
      - docker-buildx-plugin
      - docker-compose-plugin
    depends_on:
      - type: dnf
        packages: [dnf5-plugins]
    pre_install: |
      sudo dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo
    post_install: |
      sudo systemctl enable --now docker
      sudo groupadd docker
      sudo usemod -aG docker $USER

kdenlive:
  - type: flatpak
    packages: [org.kde.kdenlive]

pcsx2:
  - type: flatpak
    packages: [net.pcsx2.PCSX2]

pdfarranger:
  - type: flatpak
    packages: [com.github.jeromerobert.pdfarranger]

obs-studio:
  - type: flatpak
    packages: [com.obsproject.Studio]

discord:
  - type: flatpak
    packages: [com.discordapp.Discord]

drawing:
  - type: flatpak
    packages: [com.github.maoschanz.drawing]

flatpak:
  - type: apt
    post_install: |
      flatpak remote-add --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo

code:
  - type: snapd
    classic: true

vlc: [snapd]

postman: [snapd]

spotify: [snapd]

duckstation:
  - type: file
    url: https://github.com/stenzek/duckstation/releases/download/latest/DuckStation-x64.AppImage
    destination: ~/.local/bin/DuckStation-x64.AppImage
    post_install:
      - type: tee
        destination: ~/.local/share/applications/DuckStation-x64.desktop
        content: |
          [Desktop Entry]
          Name=DuckStation
          StartupNotify=true
          Type=Application
          Terminal=false
          Categories=Utilities;
          Exec=DuckStation-x64.AppImage

# Type pip translates into:
# pip install -U {{...packages}}

kazam:
  - type: pip
    depends_on:
      - build-essential
      - type: dnf
        packages: [python3-wheel, zlib-devel]
    post_install:
      - type: tee
        destination: ~/.local/share/applications/kazam.desktop
        content: |
          [Desktop Entry]
          Name=Kazam
          Comment=Screen recording tool
          Exec=kazam
          Icon=kazam
          Terminal=false
          Type=Application
          Categories=AudioVideo;Recorder;
          StartupNotify=true

yt-dlp:
  - type: pip
    packages: ["yt-dlp[default]"]


# Custom libraries

cspec:
  - type: github
    repository: mumuki/cspec
    install: |
      make
      sudo make install

commons:
  - type: github
    repository: sisoputnfrba/so-commons-library
    install: |
      make
      sudo make install

doctest:
  - type: file
    url: https://raw.githubusercontent.com/doctest/doctest/v2.4.12/doctest/doctest.h
    destination: /usr/local/include/doctest
    sudo: true

# "tarball" type translates into:
# curl -fsSL "{{url}}" | {{sudo}} tar xvzC "{{destination}}"

go:
  - type: tarball
    url: "https://go.dev/dl/$(curl -fsSL 'https://golang.org/VERSION?m=text' | head -n1).linux-amd64.tar.gz"
    destination: /usr/local
    sudo: true

jetbrains-toolbox:
  - type: tarball
    url: $(curl -fsSL "https://data.services.jetbrains.com/products/releases?code=TBA&latest=true&type=release" | jq -r '.TBA[0].downloads.linux.link')
    destination: /opt
    sudo: true
    post_install: |
      /opt/jetbrains-toolbox-*/bin/jetbrains-toolbox
    depends_on: [jq]

rust:
  - type: shell
    url: https://sh.rustup.rs

sdkman:
  - type: shell
    shell: zsh
    url: https://get.sdkman.io

pseint:
  - type: tarball
    url: "https://downloads.sourceforge.net/project/pseint/20230517/pseint-l64-20230517.tgz"
    destination: /opt
    sudo: true

steam:
  - type: dnf
    depends_on:
      - type: dnf
        packages:
          - "https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm"
          - "https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm"
    pre_install: |
      sudo dnf config-manager setopt fedora-cisco-openh264.enabled=1

virtualbox:
  - type: dnf
    packages: [VirtualBox-7.2]
    pre_install: |
      wget -q https://www.virtualbox.org/download/oracle_vbox_2016.asc -O- | sudo rpm --import -
    depends_on:
      - type: dnf
        packages:
          - kernel
          - kernel-core
          - kernel-modules
          - kernel-modules-core
          - kernel-modules-extra
          - kernel-tools
          - kernel-tools-libs
          - kernel-headers
          - kernel-devel

zsh:
  - type: dnf
    post_install: |
      sh -c "$(wget "https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh" -O -)"
      chsh -s $(which zsh)
  - type: apt
    post_install: |
      sh -c "$(wget "https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh" -O -)"
      chsh -s $(which zsh)

# Fonts

jetbrains-mono:
  - type: shell
    url: https://raw.githubusercontent.com/JetBrains/JetBrainsMono/master/install_manual.sh
